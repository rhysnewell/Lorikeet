<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Examples</title>
    <meta name="description" content="Documentation for Lorikeet">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/Lorikeet/assets/normalize.css?v=1701839268"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="/Lorikeet/assets/doctave-style.css?v=1701839268"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="/Lorikeet/assets/katex.css?v=1701839268" media="screen" />
    <link rel="stylesheet" type="text/css" href="/Lorikeet/assets/prism-ghcolors.css?v=1701839268"
        media="screen" />

    <script>
        var DOCTAVE_TIMESTAMP = "1701839268";
        var BASE_PATH = "/Lorikeet/";
        var color = localStorage.getItem('doctave-color')

        if (color === 'dark') {
            document.getElementsByTagName('html')[0].classList.remove('light');
            document.getElementsByTagName('html')[0].classList.add('dark');
        } else {
            document.getElementsByTagName('html')[0].classList.remove('dark');
            document.getElementsByTagName('html')[0].classList.add('light');
        }
    </script>

    
</head>

<body>
    <label for='menu-toggle-switch' class='menu-toggle-button'>
        â˜°
    </label>
    <input type="checkbox" id="menu-toggle-switch" value='0' />
    <div class='page'>
        <div class='header'>
            <div class='logo'>
                
                <a href="/Lorikeet/">
                    <img src="/Lorikeet/images/mini_logo.png" alt='Lorikeet logo'></img>
                </a>
                
                <h2 class='project-name'>
                    <a href="/Lorikeet/">
                        Lorikeet
                    </a>
                </h2>
            </div>
            <div class='search'>
                <form id='search-form'>
    <input type='text' id='search-box' autocomplete="off" placeholder="Search..."></input>
    <span class='search-icon'>S</span>
    <ul id='search-results'></ul>
</form>

            </div>
            <div class='header-dummy-right'>
            </div>
        </div>
        <div class='container'>
            <div class='sidebar-left'>
                <nav class='site-nav'>
    <ul>
        
            <li><a href="/Lorikeet/installation">Installation</a></li>
            
        
            <li><a href="/Lorikeet/usage">Usage</a></li>
            
                <ul>
    
        <li><a href="/Lorikeet/usage/lorikeet-call">lorikeet-call</a></li>
        
    
        <li><a href="/Lorikeet/usage/lorikeet-consensus">lorikeet-consensus</a></li>
        
    
        <li><a href="/Lorikeet/usage/lorikeet-genotype">lorikeet-genotype</a></li>
        
    
        <li><a href="/Lorikeet/usage/lorikeet-summarise">lorikeet-summarise</a></li>
        
    
</ul>

            
        
            <li><a href="/Lorikeet/concepts">Concepts</a></li>
            
        
            <li><a class="active" href="/Lorikeet/examples">Examples</a></li>
            
        
            <li><a href="/Lorikeet/comparisons">Comparisons</a></li>
            
        
            <li><a href="/Lorikeet/faqs">FAQs</a></li>
            
        
    </ul>
    <span id='light-dark-mode-switch'>
        <svg xmlns="http://www.w3.org/2000/svg" id="dark-mode-icon" viewBox="0 0 20 20" fill="currentColor">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
        </svg>

        <svg xmlns="http://www.w3.org/2000/svg" id="light-mode-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
        </svg>
    </span>
</nav>

            </div>
            <div class='doctave-content'>
                <h1 id="examples">Examples</h1>
<h2 id="forcing-variant-calls">Forcing Variant Calls</h2>
<p>Through use of the <code>-f, --features-vcf</code> argument it is possible to provide lorikeet with a list of known variants or variants of concern that will be forcibly called by
the algorithm if there is any activity occurring at that genomic location in the provided samples. It is possible that lorikeet
will also call any potential variation events surrounding a given location as well. This can be useful if you are more 
interested in the activity occurring around some given locations rather than specific variation events.</p>
<p>The list of variants must be provided in VCF format with some caveats on how the variant locations are written. E.g.</p>
<pre><code>##fileformat=VCFv4.2
##FILTER=&lt;ID=PASS,Description="All filters passed"&gt;
##source=lorikeet-v0.7.0
##contig=&lt;ID=random10000~random_sequence_length_10000_1,length=10000&gt;
#CHROM	POS	ID	REF	ALT	QUAL	FILTER
random10000~random_sequence_length_10000_1	223	.	G	C	1445.63	.
random10000~random_sequence_length_10000_1	435	.	G	C	1941.63	.
random10000~random_sequence_length_10000_1	949	.	T	A	383.629	.
</code></pre>
<p>Note that you need to specific both the genome name and contig name in the <code>CHROM</code> column separated by the <code>~</code> character
e.g. <code>random10000~random_sequence_length_10000_1</code>. Additionally, the standard <code>FORMAT</code> and <code>INFO</code> columns are optional when
provding a VCF file.</p>
<p>Finally, the provided VCF file must be compressed using <code>bgzip</code> and indexed using <code>bcftools index</code> e.g.</p>
<pre><code>bgzip -c random10000.vcf &gt; random10000.vcf;
bcftools index random10000.vcf.gz;
lorikeet call -r random10000.fna -1 forward_reads.fastq -2 reverse_reads.fastq -l longread.bam -f random10000.vcf.gz
</code></pre>
<h2 id="visualizing-ani-results">Visualizing ANI results</h2>
<p>The ANI tables that Lorikeet produces can feel overwhelming at first, but luckily they can be fairly easily visualized 
into interpretable and digestable heatmaps. The following is going to be a short walkthrough on the processes I have taken 
previously to generate heatmap results for a singular novel MAG.</p>
<p>Imagine we've used <a href="https://github.com/wwood/singlem">SingleM</a> to search the SRA for hits for our novel organism and then
used <a href="https://github.com/wwood/kingfisher-download">Kingfisher</a> to download all of the samples where our organism is apparently
appearing in excess of 5 times coverage and contains 10 or more gene hits. We would then pass all of these samples to Lorikeet
with our novel MAG to generate the variants, ANI tables, and optionally the strain genotypes as well. If we just wanted 
the variants and ANI tables we'd use this single command:</p>
<pre><code>lorikeet call -r novel_mag.fna -c sra_samples/*_[12].fastq* -t 30 --bam-file-cache-directory bams/ -o lorikeet_out/
</code></pre>
<p>Since this example involves mapping over 90 samples to our reference genome, I've chosen to use the <code>--bam-file-cache-directory</code>
flag so that the read mappins are saved and we can reuse them if we experience a crash or wish to change the settings. If we 
wanted to rerun Lorikeet using the BAM files generate from the mappings then we'd just change our command to:</p>
<pre><code>lorikeet call -r novel_mag.fna -b bams/short/*.bam -t 30 -o lorikeet_out/
</code></pre>
<p>Once Lorikeet has finished up, we should have an output folder filled with ANI tables in <code>lorikeet_out/novel_mag/</code>. We then
want to use some R libraries like <code>data.table</code>, <code>ggplot2</code>, and <code>plotly</code> to visualize what the results look like.</p>
<p>A simple example of this would look like:</p>
<pre><code class="language-R">library(data.table)
library(ggplot2)
library(plotly)

pop_ani &lt;- fread("lorikeet_out/novel_mag/novel_mag_population_ani.tsv", skip="SampleID",) # skip here so we skip all the contig header info
con_ani &lt;- fread("lorikeet_out/novel_mag/novel_mag_consensus_ani.tsv", skip="SampleID")
sub_pop_ani &lt;- fread("lorikeet_out/novel_mag/novel_mag_population_ani.tsv", skip="SampleID",)

## An example using consensus ANI

# sample_labels
con_ani[, SampleID:=factor(SampleID)]

tmp &lt;-heatmaply(con_ani[, -1, with=FALSE],
                  xlab = "Sample Name",
                  ylab = "Sample Name",
                  file = "con_ani_heatmap.html",
                  k_row = 1, k_col = 1, plot_method="ggplot")

</code></pre>
<p>This will produce a <code>HTML</code> file using <code>plotly</code> that should look something like <a href="/Lorikeet/figures/con_ani_heatmap.html">heatmap</a> where
dark cells indicate more distant ANI values and lighter cells represent closely related samples. This example only explores
the use of consensus ANI, but we strongly recommend using both population and subpopulation ANI to assess how your communities
are differing.</p>

            </div>
            <div class='sidebar-right'>
                <div class='page-nav' id='page-nav'>
                    <p class='page-nav-header'>On this page</p>
                    <ul>
                        
                        <li class='page-nav-level-1'>
                            <a href='#examples'>Examples</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#forcing-variant-calls'>Forcing Variant Calls</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#visualizing-ani-results'>Visualizing ANI results</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
            <div class='wave-container'>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                    <path fill-opacity="0.35"
                        d="M0,192L60,213.3C120,235,240,277,360,277.3C480,277,600,235,720,192C840,149,960,107,1080,122.7C1200,139,1320,213,1380,250.7L1440,288L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                    <path fill-opacity="0.5"
                        d="M0,160L60,181.3C120,203,240,245,360,229.3C480,213,600,139,720,138.7C840,139,960,213,1080,229.3C1200,245,1320,203,1380,181.3L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                    <path fill-opacity="0.2"
                        d="M0,224L60,197.3C120,171,240,117,360,117.3C480,117,600,171,720,186.7C840,203,960,181,1080,186.7C1200,192,1320,224,1380,240L1440,256L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                </svg>
                <p>Powered by <a href='https://cli.doctave.com' target='_blank'>Doctave</a></p>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="/Lorikeet/assets/katex.js?v=1701839268"></script>
    <script type="text/javascript" src="/Lorikeet/assets/mermaid.js?v=1701839268"></script>
    <script type="text/javascript" src="/Lorikeet/assets/elasticlunr.js?v=1701839268"></script>
    <script type="text/javascript" src="/Lorikeet/assets/prism.js?v=1701839268"></script>
    <script type="text/javascript" src="/Lorikeet/assets/doctave-app.js?v=1701839268"></script>

    
</body>

</html>