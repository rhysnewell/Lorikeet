import scipy.cluster.hierarchy as hierarchy
import numpy as np
import matplotlib.pyplot as plt

test = np.array([[0, 137, 0, 2],
[1, 136, 0, 2],
[2, 135, 0, 2],
[3, 134, 0, 2],
[4, 133, 0, 2],
[5, 132, 0, 2],
[6, 131, 0, 2],
[7, 130, 0, 2],
[8, 129, 0, 2],
[9, 128, 0, 2],
[10, 127, 0, 2],
[11, 126, 0, 2],
[12, 125, 0, 2],
[13, 124, 0, 2],
[14, 123, 0, 2],
[15, 122, 0, 2],
[16, 121, 0, 2],
[17, 120, 0, 2],
[18, 119, 0, 2],
[19, 118, 0, 2],
[20, 117, 0, 2],
[21, 116, 0, 2],
[22, 115, 0, 2],
[23, 114, 0, 2],
[24, 113, 0, 2],
[25, 112, 0, 2],
[26, 111, 0, 2],
[27, 110, 0, 2],
[28, 109, 0, 2],
[29, 108, 0, 2],
[30, 107, 0, 2],
[31, 106, 0, 2],
[32, 105, 0, 2],
[33, 104, 0, 2],
[34, 103, 0, 2],
[35, 102, 0, 2],
[36, 101, 0, 2],
[37, 100, 0, 2],
[38, 99, 0, 2],
[39, 98, 0, 2],
[40, 97, 0, 2],
[41, 96, 0, 2],
[42, 95, 0, 2],
[43, 94, 0, 2],
[44, 93, 0, 2],
[45, 92, 0, 2],
[46, 91, 0, 2],
[47, 90, 0, 2],
[48, 89, 0, 2],
[49, 88, 0, 2],
[50, 87, 0, 2],
[51, 86, 0, 2],
[52, 85, 0, 2],
[53, 84, 0, 2],
[54, 83, 0, 2],
[55, 82, 0, 2],
[56, 81, 0, 2],
[57, 80, 0, 2],
[58, 79, 0, 2],
[59, 78, 0, 2],
[60, 77, 0, 2],
[61, 76, 0, 2],
[62, 75, 0, 2],
[63, 74, 0, 2],
[64, 73, 0, 2],
[65, 72, 0, 2],
[66, 71, 0, 2],
[67, 70, 0, 2],
[68, 69, 0, 2],
[149, 197, 0.25953924863958455, 4],
[168, 195, 0.3585705349156369, 4],
[161, 163, 0.3652136756632891, 4],
[143, 160, 0.36866431003259953, 4],
[147, 174, 0.3720498445819102, 4],
[170, 196, 0.372187408562366, 4],
[186, 194, 0.38237723192289585, 4],
[169, 202, 0.38812531765039643, 4],
[153, 193, 0.3926639750330985, 4],
[154, 180, 0.3962649285006478, 4],
[139, 183, 0.39985013692615545, 4],
[175, 189, 0.4145904305060196, 4],
[155, 177, 0.4150700177678597, 4],
[176, 203, 0.4165214081715682, 4],
[165, 173, 0.42406491771546045, 4],
[212, 213, 0.42418957716207806, 8],
[145, 221, 0.42817260782351374, 6],
[141, 178, 0.4318560692893047, 4],
[204, 219, 0.4320192151700433, 6],
[148, 184, 0.4434975407008474, 4],
[156, 167, 0.44776644811642036, 4],
[162, 171, 0.4521904976970042, 4],
[144, 214, 0.46357607181113425, 6],
[140, 159, 0.4822411851795982, 4],
[192, 198, 0.4833481172050903, 4],
[210, 226, 0.489780977030849, 8],
[138, 209, 0.5057729952220746, 6],
[158, 164, 0.5079967587101506, 4],
[146, 150, 0.5089826559023108, 4],
[157, 179, 0.5199467594103494, 4],
[191, 205, 0.5207436719877367, 4],
[151, 206, 0.5211159694376752, 4],
[172, 230, 0.5277800812046581, 6],
[182, 223, 0.538301819205107, 8],
[217, 227, 0.5420131621516193, 8],
[166, 236, 0.5420732454554634, 6],
[142, 235, 0.5528483825729887, 6],
[188, 241, 0.5592397305725682, 10],
[187, 216, 0.5648008083741627, 6],
[152, 228, 0.5679854228961114, 6],
[181, 215, 0.5705067881327163, 6],
[190, 199, 0.5970367620453793, 4],
[231, 237, 0.6047018116870709, 8],
[220, 229, 0.613284598320976, 10],
[225, 240, 0.6255447247149765, 14],
[224, 239, 0.6339469968200407, 10],
[243, 246, 0.6459791223716889, 12],
[238, 247, 0.6536795995391778, 10],
[222, 252, 0.6549380323647067, 18],
[233, 253, 0.674523898164456, 18],
[185, 248, 0.6748571926488174, 6],
[200, 211, 0.6792833296506441, 6],
[201, 234, 0.6875365759572438, 6],
[242, 244, 0.6987879948172548, 16],
[218, 255, 0.7092150620188129, 22],
[245, 249, 0.7225291848585275, 14],
[208, 257, 0.7272467569549604, 10],
[207, 251, 0.7441557170377565, 18],
[250, 261, 0.7569682472905919, 32],
[254, 263, 0.7616901535582767, 20],
[232, 265, 0.8015177555433637, 40],
[258, 260, 0.8100872627998665, 22],
[259, 266, 0.845942203366657, 26],
[262, 264, 0.8679131389114346, 32],
[256, 269, 0.93382450589865, 44],
[267, 268, 0.9654951909884242, 62],
[270, 272, 1.2248662987361272, 94],
[271, 273, 2.35244595542456, 138]])

test_dict = {5650: {"C": (2, 84)},
1192: {"A": (2, 53)},
1241: {"G": (2, 67)},
2784: {"G": (1, 20)},
1206: {"G": (1, 63)},
2773: {"G": (2, 123)},
4342: {"G": (2, 117)},
5479: {"C": (2, 29)},
2357: {"C": (2, 79)},
5509: {"A": (2, 38)},
4541: {"A": (3, 95), "TA": (5, 96)},
5387: {"A": (2, 118)},
3594: {"G": (2, 62)},
736: {"A": (2, 65)},
842: {"G": (2, 89)},
770: {"C": (2, 122)},
5159: {"T": (1, 135)},
789: {"CC": (2, 81)},
3085: {"C": (2, 78)},
5562: {"T": (2, 94)},
3161: {"C": (2, 41)},
480: {"G": (2, 40)},
4675: {"G": (2, 97)},
5508: {"A": (2, 72)},
3965: {"G": (1, 14)},
4685: {"G": (2, 35)},
2323: {"A": (2, 107)},
3953: {"C": (2, 131)},
4684: {"A": (4, 28)},
422: {"C": (2, 50)},
2523: {"A": (1, 134)},
725: {"A": (1, 127)},
2327: {"A": (2, 56)},
4588: {"G": (1, 23)},
2504: {"A": (2, 37)},
4692: {"C": (2, 27)},
4830: {"C": (1, 57)},
1233: {"G": (2, 49)},
5389: {"G": (2, 64)},
4801: {"C": (2, 126)},
3703: {"C": (2, 136)},
5604: {"A": (1, 76)},
4546: {"A": (3, 90)},
4552: {"T": (3, 106)},
4557: {"A": (3, 70)},
5575: {"G": (2, 130)},
2790: {"C": (2, 34)},
820: {"T": (2, 60)},
5626: {"T": (2, 73)},
4809: {"C": (2, 42)},
3707: {"G": (2, 101)},
4556: {"C": (3, 120)},
4603: {"G": (2, 39)},
5565: {"T": (3, 102)},
1173: {"C": (2, 103)},
3692: {"C": (1, 25)},
4782: {"C": (2, 44)},
3694: {"G": (2, 9)},
4543: {"G": (5, 87)},
4687: {"A": (2, 7)},
782: {"A": (2, 108)},
5500: {"T": (1, 68)},
799: {"T": (1, 8)},
5413: {"C": (2, 132)},
1188: {"T": (2, 26)},
4554: {"A": (3, 110)},
4764: {"A": (2, 91)},
3126: {"C": (2, 59)},
2527: {"CGTT": (2, 46)},
481: {"G": (2, 3)},
5435: {"T": (2, 6)},
4542: {"T": (3, 137)},
3600: {"A": (1, 43)},
4551: {"G": (3, 88)},
3595: {"A": (4, 99)},
4550: {"T": (3, 54)},
4812: {"A": (2, 98)},
4669: {"C": (2, 86)},
2428: {"C": (1, 24)},
804: {"C": (1, 13)},
4555: {"G": (3, 124)},
492: {"T": (2, 45)},
3713: {"T": (2, 58)},
4648: {"T": (2, 66)},
824: {"T": (2, 116)},
2360: {"C": (2, 32)},
792: {"C": (2, 69)},
5417: {"A": (1, 47)},
3087: {"G": (2, 85)},
3065: {"T": (2, 11)},
4545: {"G": (3, 16)},
2518: {"G": (2, 22)},
2555: {"T": (2, 128)},
3080: {"C": (2, 105)},
4638: {"C": (2, 17)},
5151: {"AATAT": (5, 75)},
1356: {"TN": (2, 109)},
5426: {"T": (2, 114)},
3114: {"A": (1, 12)},
2342: {"G": (2, 48)},
4606: {"C": (1, 112)},
463: {"G": (2, 1)},
2535: {"C": (2, 10)},
419: {"C": (1, 104)},
5415: {"C": (2, 31)},
5379: {"C": (2, 71)},
2497: {"C": (2, 5)},
4835: {"C": (1, 30)},
4562: {"G": (1, 0)},
4633: {"G": (2, 19)},
2502: {"G": (2, 51)},
858: {"T": (1, 133)},
4147: {"A": (2, 93)},
2525: {"C": (1, 33)},
2776: {"G": (1, 111)},
2892: {"A": (2, 2)},
3174: {"C": (2, 92)},
5598: {"G": (1, 119)},
2860: {"CTG": (1, 125)},
4320: {"A": (4, 129)},
4160: {"G": (2, 61)},
1191: {"G": (2, 115)},
3952: {"C": (1, 52)},
5529: {"G": (2, 121)},
4548: {"C": (3, 77)},
1230: {"T": (2, 83)},
5537: {"GCC": (1, 55)},
4742: {"A": (1, 100)},
3657: {"CC": (1, 4)},
438: {"A": (2, 18)},
2424: {"C": (2, 21)},
479: {"G": (1, 80)},
1165: {"C": (1, 82)},
5503: {"C": (1, 15)},
4752: {"G": (4, 113)},
4805: {"A": (2, 74)},
3665: {"AAG": (5, 36)}}


test_clust = {}

for (pos, var_map) in test_dict.items():
    for (var, tup) in var_map.items():
        test_clust[tup[1]] = (tup[0], pos)


plt.figure(figsize=[12,10])
hierarchy.dendrogram(test, leaf_label_func=lambda id: test_clust[id], color_threshold=0.4*max(test[:,2]))
plt.show()