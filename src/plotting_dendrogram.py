import scipy.cluster.hierarchy as hierarchy
import numpy as np
import matplotlib.pyplot as plt

test = np.array([[45, 93, 0, 2],
[24, 114, 0, 2],
[33, 105, 0, 2],
[63, 75, 0, 2],
[59, 79, 0, 2],
[52, 86, 0, 2],
[26, 112, 0, 2],
[115, 139, 0, 3],
[12, 126, 0, 2],
[94, 138, 0, 3],
[53, 85, 0, 2],
[3, 135, 0, 2],
[25, 113, 0, 2],
[28, 110, 0, 2],
[31, 107, 0, 2],
[47, 91, 0, 2],
[39, 99, 0, 2],
[35, 103, 0, 2],
[46, 92, 0, 2],
[49, 89, 0, 2],
[4, 134, 0, 2],
[13, 125, 0, 2],
[6, 132, 0, 2],
[57, 81, 0, 2],
[41, 97, 0, 2],
[29, 109, 0, 2],
[67, 71, 0, 2],
[32, 106, 0, 2],
[30, 108, 0, 2],
[8, 130, 0, 2],
[10, 128, 0, 2],
[16, 122, 0, 2],
[44, 95, 0, 2],
[9, 129, 0, 2],
[50, 88, 0, 2],
[36, 102, 0, 2],
[17, 121, 0, 2],
[40, 98, 0, 2],
[58, 80, 0, 2],
[22, 116, 0, 2],
[48, 90, 0, 2],
[117, 145, 0, 4],
[27, 111, 0, 2],
[55, 83, 0, 2],
[19, 119, 0, 2],
[76, 141, 0, 3],
[64, 74, 0, 2],
[82, 142, 0, 3],
[87, 143, 0, 3],
[65, 73, 0, 2],
[68, 70, 0, 2],
[51, 96, 0, 2],
[21, 118, 0, 2],
[15, 123, 0, 2],
[43, 100, 0, 2],
[11, 127, 0, 2],
[120, 150, 0, 3],
[124, 140, 0, 3],
[101, 156, 0, 3],
[104, 153, 0, 3],
[5, 133, 0, 2],
[54, 84, 0, 2],
[136, 160, 0, 3],
[69, 72, 0, 2],
[131, 155, 0, 3],
[137, 157, 0, 3],
[60, 78, 0, 2],
[62, 77, 0, 2],
[37, 165, 0.032003891195088084, 3],
[34, 206, 0.05680476339023391, 4],
[20, 198, 0.07508698033028412, 3],
[66, 176, 0.09072184232530289, 3],
[18, 167, 0.1380589234069417, 3],
[38, 56, 0.13872938249727373, 2],
[23, 182, 0.216484754452799, 3],
[151, 202, 0.26178262347638204, 5],
[196, 197, 0.29986104838775707, 6],
[61, 191, 0.31883690559949596, 3],
[178, 203, 0.32793893250605033, 5],
[147, 172, 0.33122824630972214, 5],
[175, 179, 0.3559581224901931, 6],
[188, 193, 0.35904130531072803, 4],
[189, 192, 0.3596860230238953, 4],
[170, 220, 0.3962043717857927, 6],
[42, 180, 0.4111859562758358, 3],
[164, 201, 0.4118868955457335, 4],
[161, 194, 0.4191130423159738, 5],
[7, 200, 0.4423335112673666, 4],
[14, 146, 0.44767728057345896, 3],
[173, 216, 0.4561744932310036, 7],
[169, 181, 0.45927310973977525, 4],
[152, 224, 0.47046092856580346, 7],
[171, 211, 0.47271214801251654, 4],
[154, 195, 0.4819225273726969, 5],
[168, 187, 0.48531792841417226, 4],
[158, 225, 0.4904728435302844, 6],
[174, 217, 0.4926824359675534, 7],
[148, 149, 0.5073229280924384, 4],
[144, 218, 0.5090414733060674, 8],
[163, 222, 0.5107391322279049, 5],
[207, 210, 0.5112057443658186, 7],
[184, 214, 0.5184497657166776, 8],
[177, 234, 0.5185773999956025, 9],
[183, 185, 0.5269258106847798, 6],
[213, 231, 0.5323949056805849, 10],
[186, 241, 0.5363111115048697, 9],
[159, 199, 0.5434209606606127, 4],
[190, 229, 0.5680879489938511, 9],
[166, 242, 0.5966555510055195, 12],
[1, 232, 0.5978171754666015, 5],
[227, 236, 0.604158893664451, 15],
[162, 244, 0.6043167313912325, 6],
[205, 243, 0.6127577512705084, 11],
[204, 239, 0.6164350907982432, 10],
[215, 237, 0.6398348451739795, 8],
[209, 238, 0.6564699545997413, 10],
[0, 247, 0.6565284705274804, 6],
[212, 226, 0.6596666790177972, 6],
[228, 246, 0.6653715336971321, 16],
[235, 249, 0.6762941185175515, 10],
[221, 251, 0.7004184291201876, 16],
[248, 256, 0.7060855744719464, 31],
[219, 252, 0.7085202657572962, 12],
[223, 250, 0.7115127843255119, 15],
[2, 230, 0.7130158877065339, 5],
[245, 259, 0.732829402599104, 40],
[233, 257, 0.7437905283383976, 16],
[260, 262, 0.7623770787768296, 17],
[208, 254, 0.7884923599194035, 9],
[255, 264, 0.832308291881697, 22],
[240, 263, 0.8526707185316919, 49],
[258, 268, 0.9325381666754603, 65],
[265, 267, 1.0679037946045622, 39],
[261, 269, 1.0919541298519528, 80],
[253, 266, 1.1050045304606484, 19],
[271, 272, 1.6775711115522023, 99],
[270, 273, 2.0891419541874496, 138]])

test_dict = {5650: {"C": (2, 84)},
1192: {"A": (2, 53)},
1241: {"G": (2, 67)},
2784: {"G": (1, 20)},
1206: {"G": (1, 63)},
2773: {"G": (2, 123)},
4342: {"G": (2, 117)},
5479: {"C": (2, 29)},
2357: {"C": (2, 79)},
5509: {"A": (2, 38)},
4541: {"A": (3, 95), "TA": (5, 96)},
5387: {"A": (2, 118)},
3594: {"G": (2, 62)},
736: {"A": (2, 65)},
842: {"G": (2, 89)},
770: {"C": (2, 122)},
5159: {"T": (1, 135)},
789: {"CC": (2, 81)},
3085: {"C": (2, 78)},
5562: {"T": (2, 94)},
3161: {"C": (2, 41)},
480: {"G": (2, 40)},
4675: {"G": (2, 97)},
5508: {"A": (2, 72)},
3965: {"G": (1, 14)},
4685: {"G": (2, 35)},
2323: {"A": (2, 107)},
3953: {"C": (2, 131)},
4684: {"A": (4, 28)},
422: {"C": (2, 50)},
2523: {"A": (1, 134)},
725: {"A": (1, 127)},
2327: {"A": (2, 56)},
4588: {"G": (1, 23)},
2504: {"A": (2, 37)},
4692: {"C": (2, 27)},
4830: {"C": (1, 57)},
1233: {"G": (2, 49)},
5389: {"G": (2, 64)},
4801: {"C": (2, 126)},
3703: {"C": (2, 136)},
5604: {"A": (1, 76)},
4546: {"A": (3, 90)},
4552: {"T": (3, 106)},
4557: {"A": (3, 70)},
5575: {"G": (2, 130)},
2790: {"C": (2, 34)},
820: {"T": (2, 60)},
5626: {"T": (2, 73)},
4809: {"C": (2, 42)},
3707: {"G": (2, 101)},
4556: {"C": (3, 120)},
4603: {"G": (2, 39)},
5565: {"T": (3, 102)},
1173: {"C": (2, 103)},
3692: {"C": (1, 25)},
4782: {"C": (2, 44)},
3694: {"G": (2, 9)},
4543: {"G": (5, 87)},
4687: {"A": (2, 7)},
782: {"A": (2, 108)},
5500: {"T": (1, 68)},
799: {"T": (1, 8)},
5413: {"C": (2, 132)},
1188: {"T": (2, 26)},
4554: {"A": (3, 110)},
4764: {"A": (2, 91)},
3126: {"C": (2, 59)},
2527: {"CGTT": (2, 46)},
481: {"G": (2, 3)},
5435: {"T": (2, 6)},
4542: {"T": (3, 137)},
3600: {"A": (1, 43)},
4551: {"G": (3, 88)},
3595: {"A": (4, 99)},
4550: {"T": (3, 54)},
4812: {"A": (2, 98)},
4669: {"C": (2, 86)},
2428: {"C": (1, 24)},
804: {"C": (1, 13)},
4555: {"G": (3, 124)},
492: {"T": (2, 45)},
3713: {"T": (2, 58)},
4648: {"T": (2, 66)},
824: {"T": (2, 116)},
2360: {"C": (2, 32)},
792: {"C": (2, 69)},
5417: {"A": (1, 47)},
3087: {"G": (2, 85)},
3065: {"T": (2, 11)},
4545: {"G": (3, 16)},
2518: {"G": (2, 22)},
2555: {"T": (2, 128)},
3080: {"C": (2, 105)},
4638: {"C": (2, 17)},
5151: {"AATAT": (5, 75)},
1356: {"TN": (2, 109)},
5426: {"T": (2, 114)},
3114: {"A": (1, 12)},
2342: {"G": (2, 48)},
4606: {"C": (1, 112)},
463: {"G": (2, 1)},
2535: {"C": (2, 10)},
419: {"C": (1, 104)},
5415: {"C": (2, 31)},
5379: {"C": (2, 71)},
2497: {"C": (2, 5)},
4835: {"C": (1, 30)},
4562: {"G": (1, 0)},
4633: {"G": (2, 19)},
2502: {"G": (2, 51)},
858: {"T": (1, 133)},
4147: {"A": (2, 93)},
2525: {"C": (1, 33)},
2776: {"G": (1, 111)},
2892: {"A": (2, 2)},
3174: {"C": (2, 92)},
5598: {"G": (1, 119)},
2860: {"CTG": (1, 125)},
4320: {"A": (4, 129)},
4160: {"G": (2, 61)},
1191: {"G": (2, 115)},
3952: {"C": (1, 52)},
5529: {"G": (2, 121)},
4548: {"C": (3, 77)},
1230: {"T": (2, 83)},
5537: {"GCC": (1, 55)},
4742: {"A": (1, 100)},
3657: {"CC": (1, 4)},
438: {"A": (2, 18)},
2424: {"C": (2, 21)},
479: {"G": (1, 80)},
1165: {"C": (1, 82)},
5503: {"C": (1, 15)},
4752: {"G": (4, 113)},
4805: {"A": (2, 74)},
3665: {"AAG": (5, 36)}}


test_clust = {}

for (pos, var_map) in test_dict.items():
    for (var, tup) in var_map.items():
        test_clust[tup[1]] = (tup[0], pos)



plt.figure(figsize=[12,10])
# hierarchy.dendrogram(test, leaf_label_func=lambda id: test_clust[id], color_threshold=0.4*max(test[:,2]))
hierarchy.dendrogram(test, color_threshold=0.4*max(test[:,2]))

plt.show()